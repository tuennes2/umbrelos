services:
  app_proxy:
    environment:
      APP_HOST: home-kopia_server_1
      APP_PORT: 51515

  server:
    image: kopia/kopia:latest
    container_name: home-kopia_server
    restart: unless-stopped
    environment:
      # Setze hier ein starkes Admin-Passwort
      KOPIA_PASSWORD: "welcome1"
    volumes:
      # Kopia-Konfiguration/Cache/Logs (persistente Daten der App)
      - ${APP_DATA_DIR}/config:/app/config
      - ${APP_DATA_DIR}/cache:/app/cache
      - ${APP_DATA_DIR}/logs:/app/logs

      # Beispiel: gesamte Umbrel-App-Datenstruktur als Quelle f체r Backups
      # (Du kannst hier weitere Pfade erg채nzen oder einschr채nken)
      - /home/umbrel/umbrel/app-data:/data:ro

    # Kein direkter Host-Port, Zugriff geht 체ber app_proxy / Umbrel-Reverse-Proxy
    networks:
      default:
        aliases:
          - home-kopia

networks:
  default:
    driver: bridge
